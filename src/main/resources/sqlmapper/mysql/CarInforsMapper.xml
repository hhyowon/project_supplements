<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Diet">
    <!-- 검색 -->
	
    <select id="search" parameterType="Map" resultType="Map">
        SELECT NAME, COMMON_CODE_ID, DESCRIPTION, PARENT_COMMON_CODE_ID
        FROM db_cars.commons_code
        ORDER BY PARENT_COMMON_CODE_ID DESC;
        <choose>
            <when test="search == 'NAME'">
            and NAME like CONCAT(#{words}, '%')
            </when>
        </choose>        
        ;
	</select>

    <!-- 입력 -->
    <insert id="insert" parameterType="Map">
        INSERT INTO COMMONS_CODE 
            (COMMON_CODE_ID, NAME, ORDER_NUMBER, 
            ATTRIBUTION_1, ATTRIBUTION_2, DESCRIPTION, 
            SYSTEM_CODE_YN, USE_YN, PARENT_COMMON_CODE_ID, 
            REGISTER_SEQ, REGISTRY_DATE, MODIFIER_SEQ, MODIFY_DATE )
        VALUES 
            (#{COMMON_CODE_ID}, #{NAME}, #{ORDER_NUMBER}, #{ATTRIBUTION_1}, 
            #{ATTRIBUTION_2}, #{DESCRIPTION}, #{SYSTEM_CODE_YN}, #{USE_YN}, 
            #{PARENT_COMMON_CODE_ID}, #{REGISTER_SEQ}, #{REGISTRY_DATE}, 
            #{MODIFIER_SEQ}, #{MODIFY_DATE})
    </insert>

     <!-- 삭제 -->
	<delete id="delete" parameterType="Map">
        delete from commons_code
        where COMMON_CODE_ID = #{COMMON_CODE_ID}
    </delete>

    <!-- 수정 -->
	<update id="update" parameterType="Map">
        UPDATE COMMONS_CODE
        SET
        NAME = #{NAME},
        ORDER_NUMBER = #{ORDER_NUMBER},
        DESCRIPTION = #{DESCRIPTION},
        MODIFY_DATE = NOW()
        where COMMON_CODE_ID = #{COMMON_CODE_ID}
    </update>

    <!-- 상세 정보-->
   <select id="detail" parameterType="Map" resultType="Map">
    SELECT
        NAME, COMMON_CODE_ID, DESCRIPTION,
        SYSTEM_CODE_YN, USE_YN, PARENT_COMMON_CODE_ID
    FROM db_cars.commons_code
    WHERE COMMON_CODE_ID = #{COMMON_CODE_ID}
    </select>

   <!-- 검색창 -->
	<select id="select" parameterType="Map" resultType="Map">
        SELECT NAME, COMMON_CODE_ID, PARENT_COMMON_CODE_ID
        FROM project_nutrients.commons_code
        WHERE PARENT_COMMON_CODE_ID = #{PARENT_COMMON_CODE_ID}
	</select>
</mapper>

